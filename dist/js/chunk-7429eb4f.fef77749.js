(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7429eb4f"],{"0e11":function(t,e,i){"use strict";var s=i("4b42"),n=i.n(s);n.a},"2ee5":function(t,e,i){},"4b42":function(t,e,i){},b127:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"music_page"},[t.$route.meta.showTop?i("me-top"):t._e(),i("div",{staticClass:"child_page"},[i("transition",{attrs:{name:t.$route.meta.aniName}},[i("router-view",{staticClass:"item_page",attrs:{"wechat-title":""}})],1)],1),i("div",{staticClass:"dd_bg_pic",style:{backgroundImage:t.picUrl}}),i("div",{staticClass:"dd_bg_mask"})],1)},n=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"me_top"},[i("van-icon",{attrs:{name:"arrow-left",color:"hsla(0,0%,100%,.7)"},on:{click:t.goback}}),i("div",[t._v(t._s(t.title))]),i("van-icon",{attrs:{name:"search",color:"hsla(0,0%,100%,.7)"}})],1)},c=[],o=i("ae8c"),l={data(){return{}},computed:{...Object(o["c"])(["currentMusic"]),title(){return"/music/lyric"==this.$route.path&&this.currentMusic&&this.currentMusic.name?this.currentMusic.name:this.$route.meta.title}},mounted(){console.log(this.$route)},methods:{goback(){history.go(-1)}}},u=l,a=(i("0e11"),i("4023")),h=Object(a["a"])(u,r,c,!1,null,"2b519bf0",null),d=h.exports,m=i("ca00");const y={initAudio(t){const e=t.audioEle;e.onprogress=()=>{try{if(e.buffered.length>0){const i=t.currentMusic.duration;let s=0;e.buffered.end(0),s=e.buffered.end(0)>i?i:e.buffered.end(0);let n=s/i;t.setCurrentProgress(n)}}catch(i){}},e.onplay=()=>{let e;clearTimeout(e),e=setTimeout(()=>{t.musicReady=!0},100)},e.ontimeupdate=()=>{t.setCurrentTime(e.currentTime)},e.onended=()=>{"loop"==t.mode?t.loop():t.nextSong()},e.onerror=()=>{t.nextSong()},e.onstalled=()=>{let i;e.load(),t.setPlaying(!1),clearTimeout(i),i=setTimeout(()=>{t.setPlaying(!0)},10)},e.oncanplay=async()=>{let e=t.historyListt.filter(e=>e.id==t.currentMusic.id);0==e.length&&(t.historyListt.push(t.currentMusic),t.setHistorylist(t.historyListt))}}};var p=y,f={components:{meTop:d},data(){return{}},mounted(){this.$nextTick(()=>{p.initAudio(this),this.audioEle.volume=this.isMute?0:this.volume})},computed:{picUrl(){return this.currentMusic.id&&this.currentMusic.image?`url(${this.currentMusic.image}?param=300y300)`:"url("+i("f2c8")+")"},...Object(o["c"])(["audioEle","playlist","currentIndex","currentMusic","currentTime","playing","mode","historyList","lyric","nolyric","volume","isMute","lastVolumn"]),historyListt:{get(){return this.historyList},set(){}}},watch:{currentMusic(t,e){t.id?t.id!==e.id&&(this.audioEle.src=t.url,this.setLyricIndex(0),this.setCurrentProgress(0),Object(m["c"])(this.audioEle.play()),this.$nextTick(()=>{this._getLyric(t.id)})):this.setLyric([])},playing(t){const e=this.audioEle;this.$nextTick(()=>{t?Object(m["c"])(e.play()):e.pause()})},currentTime(t){if(this.nolyric)return;let e=0;for(let i=0;i<this.lyric.length;i++)t>this.lyric[i].time&&(e=i);this.setLyricIndex(e)},volume(t){let e=0==t;this.setIsMute(e),this.audioEle.volume=t},isMute(t){t?(this.setLastvolumn(this.volume),this.setVolume(0)):this.setVolume(this.lastVolumn)}},methods:{async _getLyric(t){let e={id:t};await this.$get(this.$api.music_lyric,e).then(async t=>{if(t.body.nolyric)this.setNolyric(!0);else{this.setNolyric(!1);let e=await Object(m["b"])(t.body.lrc.lyric);this.setLyric(e)}Object(m["c"])(this.audioEle.play())})},nextSong(){if(1===this.playlist.length)this.loop();else{let t="";"listLoop"===this.mode?(t=this.currentIndex+1,t===this.playlist.length&&(t=0)):"random"===this.mode&&(t=Math.floor(Math.random()*this.playlist.length)),this.playing||this.setPlaying(!0),this.setCurrentIndex(t)}},pause(){this.playing=!this.playing,this.setPlaying(this.playing)},loop(){this.audioEle.currentTime=0,Object(m["c"])(this.audioEle.play()),this.setPlaying(!0),this.lyric.length>0&&this.setLyricIndex(0)},...Object(o["d"])({setPlaying:"SET_PLAYING",setCurrentIndex:"SET_CURRENTINDEX",setCurrentTime:"SET_CURRENTTIME",setCurrentProgress:"SET_CURRENTPROGRESS",setNolyric:"SET_NOLYRIC",setLyric:"SET_LYRIC",setLyricIndex:"SET_LYRICINDEX",setIsMute:"SET_ISMUTE",setLastvolumn:"SET_LASTVOLUMN"}),...Object(o["b"])(["setHistorylist","setVolume"])}},g=f,b=(i("f910"),Object(a["a"])(g,s,n,!1,null,"312f8e32",null));e["default"]=b.exports},ca00:function(t,e,i){"use strict";i.d(e,"b",(function(){return r})),i.d(e,"a",(function(){return c})),i.d(e,"c",(function(){return l}));function s(t){return t<10?"0"+t:t}const n=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g;function r(t){const e=t.split("\n"),i=[];for(let s=0;s<e.length;s++){const t=e[s],r=n.exec(t);if(!r)continue;const c=t.replace(n,"").trim();c&&i.push({time:(6e4*r[1]+1e3*r[2]+1*(r[3]||0))/1e3,text:c})}return i}function c(t){let e=Math.floor(t/60),i=Math.floor(t%60);return`${s(e)}:${s(i)}`}function o(t){return void 0!==t&&null!==t&&"function"===typeof t.then}function l(t){o(t)&&t.then(null,()=>{})}},f2c8:function(t,e,i){t.exports=i.p+"img/bg.d681d4ef.jpg"},f910:function(t,e,i){"use strict";var s=i("2ee5"),n=i.n(s);n.a}}]);
//# sourceMappingURL=chunk-7429eb4f.fef77749.js.map